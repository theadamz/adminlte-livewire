import{c as h,e as _,s,g,h as v,j as T,o as x,i,k as l,l as w,a as c,M as o,r as u,f as m,_ as S,m as r,n as y}from"./general-EKVRape8.js";let f=null,p=null;function k(){_dataTable=$("#list_datatable").DataTable({lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],pageLength:50,numbers_length:4,searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,stateSave:_dataTableUseState,stateDuration:_dataTableStateDuration,scrollY:_dataTableScrollY,order:[[0,"asc"]],select:{items:"row",style:"single",className:"bg-warning"},headerCallback:function(a,e,t,n,M){a.getElementsByTagName("th")[0].innerHTML=`
            <div class="form-check">
               <input class="form-check-input datatable-group-checkable" type="checkbox" value="" id="groupCheckable" />
					<label class="form-check-label"></label>
            </div>`},createdRow:function(a,e,t){_dataTableSelectedValues.indexOf(e[_dataTableSelectColumn])>-1&&$(a).addClass("bg-light")},ajax:{url:`${_baseURL}/dt/basics/warehouses`,type:"GET",data:function(a){a.is_active=$("#filter_is_active").val()}},columns:[{data:"id",width:"30px",orderable:!1,searchable:!1,render:function(a,e,t,n){return`<div class="form-check">
                               <input class="form-check-input datatable-checkable" type="checkbox" value="${a}" ${_dataTableSelectedValues.indexOf(a)>-1?"checked":""} data-index="${n.row}" />
                                        <label class="form-check-label"></label>
                            </div>`}},{data:"code"},{data:"name"},{data:"address"},{data:"telephone"},{data:"fax"},{data:"warehouse_locations_count",orderable:!1,searchable:!1,className:"dt-center"},{data:"is_active",className:"dt-center",searchable:!1,render:function(a,e,t,n){return h(a)?'<span class="badge font-weight-normal badge-success">Yes</span>':'<span class="badge font-weight-normal badge-warning">No</span>'}}]}).on("xhr.dt",function(a,e,t,n){setTimeout(()=>{_dataTable.columns.adjust()},300)}).on("draw.dt",function(a,e,t,n){_(_dataTable),s(!1,"#refresh")}),g(_dataTable,'input[type="search"]'),document.querySelector("#refresh").addEventListener("click",()=>d(!1)),document.querySelector("#filterReset").addEventListener("click",U),document.querySelector("#formFilter").addEventListener("submit",a=>{a.preventDefault(),d(),$("#modalFormFilter").modal("hide")})}function L(){_formValidation=$(document.querySelector("#formInput")).validate({rules:{code:{required:!0,regex:v},name:{required:!0}},submitHandler:function(a,e){e.preventDefault(),$(a).valid()&&F()}}),p=$(document.querySelector("#formImport")).validate({rules:{file:{required:!0,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",extension:"xlsx",filesize:2048}},submitHandler:N})}function I(){$("#modalFormInput").on("hidden.bs.modal",b),T("#modalFormInput")}function D(){_permissions.edit&&document.querySelector("#edit").addEventListener("click",()=>{typeof _dataTable.row({selected:!0}).data()>"u"||C(_dataTable.row({selected:!0}).data().id.trim())}),_permissions.delete&&document.querySelector("#delete").addEventListener("click",q),_permissions.export&&document.querySelector("#export").addEventListener("click",R),x(document.querySelector("#location"))&&document.querySelector("#location").addEventListener("click",()=>{const a=_dataTable.row({selected:!0}).data();a&&(location.href=`${_baseURL}/basics/warehouses/${a.id}/locations`)})}function E(){i("#code"),i("#name"),i("#address"),i("#telephone"),i("#fax")}async function F(){s(!0,"#save"),l("#formInput"),f=`${_baseURL}/basics/warehouses`,_action==="edit"&&(f+=`/${_id}`);const a=_action==="create"?"POST":"PUT";_data2Send=w($("#formInput").serialize(),!1),_data2Send.is_active=$("#is_active").is(":checked");const e=await c(f,a,_data2Send,"application/json");if(![201,200].includes(e.status)){o.HtmlNotification(u(e.data),`${e.status} - ${e.statusText}`),m(e.data.errors),s(!1,"#save"),l("#formInput",!1);return}Toast.fire({icon:"success",title:e.statusText,text:e.data.message}),b(),d(!1),$("#modalFormInput").modal("hide"),s(!1,"#save"),l("#formInput",!1)}async function C(a=null){_id=a,l("#list_datatable");const e=await c(`${_baseURL}/basics/warehouses/${_id}`,"GET");if(![200].includes(e.status)){o.HtmlNotification(u(e.data),`${e.status} - ${e.statusText}`),l("#list_datatable",!1);return}b(),_action="edit";const t=e.data.data;$("#code").val(t.code),$("#name").val(t.name),$("#address").val(t.address),$("#telephone").val(t.telephone),$("#fax").val(t.fax),$("#is_active").prop("checked",h(t.is_active)),$("#modalFormInput").modal("show"),l("#list_datatable",!1)}async function q(){if(_dataTableSelectedValues.length<=0){o.HtmlNotification("Select 1 atau more data.");return}if(!await o.Confirm(`Are you sure want to delete ${_dataTableSelectedValues.length} data?`).catch(t=>{t&&console.log(t)}))return;s(!0,"#delete"),l("#list_datatable"),_data2Send=new URLSearchParams({id:JSON.stringify(_dataTableSelectedValues)});const e=await c(`${_baseURL}/basics/warehouses`,"DELETE",_data2Send);if(![200].includes(e.status)){o.HtmlNotification(u(e.data),`${e.status} - ${e.statusText}`),m(e.data.errors),s(!1,"#delete"),l("#list_datatable",!1);return}Toast.fire({icon:"success",title:e.statusText,text:e.data.message}),S(),d(!1),s(!1,"#delete"),l("#list_datatable",!1)}async function N(){if(!await o.Confirm("Are you sure?").catch(t=>{t&&console.log(t)}))return;$("#logs").val(null),s(!0,"#upload"),r(!0),_data2Send=new FormData($("#formImport")[0]);const e=await c(`${_baseURL}/basics/warehouses/imports`,"POST",_data2Send,null);if(![201].includes(e.status)){s(!1,"#upload"),r(!1),o.HtmlNotification(u(e.data),`${e.status} - ${e.statusText}`),m(e.data.errors,p),$("#logs").val(e.data.logs);return}s(!1,"#upload"),r(!1),Toast.fire({icon:"success",title:e.statusText,text:e.data.message}),$("#logs").val(e.data.logs),V(),d(!1),$("#modalFormInput").modal("hide")}async function R(){if(!await o.Confirm("Are you sure?").catch(t=>{t&&console.log(t)}))return;r(!0,"Please wait","Processing data...");const e=await c(`${_baseURL}/basics/warehouses/exports`,"POST",{is_active:$("#filter_is_active").val()},"application/json");if(![200].includes(e.status)){o.HtmlNotification(u(e.data),`${e.status} - ${e.statusText}`);return}y(e.data.url),r(!1)}function d(a=!0){s(!0,"#refresh"),_dataTableResetFilter=!1,_dataTable.ajax.reload(null,a)}function b(){_action="create",_data2Send=null,_formValidation.resetForm(),$("#formInput")[0].reset(),$("#is_active").prop("checked",!0)}function U(){$('#filter_is_active option[value=""]').prop("selected",!0).change(),$("#formFilter")[0].reset()}function V(){_data2Send=null,p.resetForm(),$("#file").next().html("Choose file"),$("#file").val("")}document.addEventListener("DOMContentLoaded",function(){k(),L(),I(),E(),D()});
