import{j as m,g as h,M as c,m as i,a as g,r as v}from"./general-EKVRape8.js";function x(){$("#_table_data_lov tbody").off("dblclick"),$("#_modal_lov").off("hidden.bs.modal"),_dataTableLOV.destroy(),$("#_dynamic_content").empty()}function p(a){let t="";$("#_table_data_lov thead").remove(),t='<thead><tr class="text-gray-900 fw-bolder align-middle border-top border-top-dashed border-bottom border-bottom-dashed border-secondary">',$.each(a,function(e,l){t=t+"<th>"+l+"</th>"}),t=t+"<th></th>",t=t+"</tr></thead>",$("#_table_data_lov").append(t)}function T(){DT_columns.push({data:null,width:40,className:"text-center"}),DT_definitions.push({targets:-1,orderable:!1,searchable:!1,render:function(a,t,e,l){return`<button class="btn btn-sm btn-icon btn-flex btn-light btn-active-success datatable-lov-send-values" data-row="${l.row}" data-toggle="tooltip" data-placement="top" title="Get values"><i class="fa fa-arrow-right"></i></button>`}}),_dataTableLOV=$("#_table_data_lov").DataTable({pageLength:5,pagingType:"simple",lengthMenu:[5,10,20],searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,search:{search:_initSearch},select:{items:"row",style:"os",className:"bg-light"},ajax:{url:`${_srcURL}?${_queryParameters}`,type:"GET"},columns:DT_columns,columnDefs:DT_definitions,order:DT_orders}).on("xhr.dt",function(a,t,e,l){setTimeout(()=>{_dataTableLOV.columns.adjust()},300)}).on("draw.dt",function(a,t,e,l){const o=document.getElementsByClassName("datatable-lov-send-values");for(const n of o)n.addEventListener("click",()=>u(n.getAttribute("data-row")))}),h(_dataTableLOV,'[aria-controls="_table_data_lov"]')}function u(a){_dataTableLOV.data().count()<=0||($resultFromLOV={result:!0,data:_dataTableLOV.row(a).data()},$("#_modal_lov").modal("hide"))}function L(a=!0){_dataTableLOVResetFilter=!1,_dataTableLOV.ajax.reload(null,a)}function w(){m("#_modal_lov"),p(DT_headers),T(),$("#_table_data_lov tbody").on("dblclick","tr",function(){u(_dataTableLOV.row(this).index())}),$("#_modal_lov").on("hidden.bs.modal",function(){x()}),$("#_modal_button_refresh").on("click",function(){L()})}async function V(){if(!await c.Confirm("clear cache?").catch(e=>{e&&console.log(e)}))return;i(!0,"Please wait","Clearing Cache...");const t=await g(`${_baseURL}/cache-clear`,"GET",null);if(![200].includes(t.status)){c.HtmlNotification(v(t.data),`${t.status} - ${t.statusText}`);return}Toast.fire({icon:"success",title:t.statusText,text:t.data.message})}const D={defaultResult:a=>a.id&&a.text||!a.id?a.text:`${a.name}`,defaultSelection:a=>a.id&&a.text||!a.id?a.text:`${a.name}`,userResult:a=>a.id?`<div class="d-flex flex-column">
                    <span class="font-weight-bold">${a.name}</span>
                    <span class="font-weight-light">${a.email}</span>
                </div>`:a.text,userSelection:a=>a.id&&a.text||!a.id?a.text:`${a.name}`,userSelectionNameEmail:a=>a.id&&a.text||!a.id?a.text:`<div class="d-flex">
                    <span class="font-weight-bold mr-1">${a.name}</span>
                    <span class="font-weight-light">(${a.email})</span>
                </div>`},r={data:{},init:({url:a,buttonOpenLOVElement:t=null,buttonClearLOVElement:e=null,hiddenElement:l,captionElement:o,descriptionElement:n=null,dependencyElement:s=null,hiddenColumnName:d="id",captionColumnName:f="name",descriptionColumnName:_="description",modalSize:b="modal-lg"})=>{t=t||`${l}LOV`,document.querySelector(`${t}`).addEventListener("click",function(){s&&!$(`${s}`).val()||r.load({url:a,hiddenElement:l,captionElement:o,descriptionElement:n,hiddenColumnName:d,captionColumnName:f,descriptionColumnName:_,modalSize:b})}),e&&document.querySelector(`${e}`).addEventListener("click",function(){r.clearElements()})},load:({url:a,hiddenElement:t,captionElement:e,descriptionElement:l=null,hiddenColumnName:o="id",captionColumnName:n="name",descriptionColumnName:s="description",modalSize:d="modal-lg"})=>{i(),$("#_dynamic_content").load(`${a}`,()=>{i(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass(`${d}`),w(),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(r.data[o]==$resultFromLOV.data[o])return;r.data[o]=$resultFromLOV.data[o],$(`${t}`).val($resultFromLOV.data[o]),$(`${e}`).val($resultFromLOV.data[n]),l&&$(`${l}`).text($resultFromLOV.data[s])}})})},clearElements:({hiddenElement:a,captionElement:t,descriptionElement:e})=>{$(`${a}`).val(null),$(`${t}`).val(null),e&&$(`${e}`).text(null)}};export{V as c,r as l,D as s};
