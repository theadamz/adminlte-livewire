import{e as b,s as l,g as _,j as h,i as f,k as s,a as r,M as n,r as d,f as m,_ as p}from"./general-EKVRape8.js";let o=null;function T(){_dataTable=$("#list_datatable").DataTable({lengthMenu:[[10,25,50,100,-1],[10,25,50,100,"All"]],pageLength:50,numbers_length:4,searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,stateSave:_dataTableUseState,stateDuration:_dataTableStateDuration,scrollY:_dataTableScrollY,order:[[0,"asc"]],select:{items:"row",style:"single",className:"bg-warning"},headerCallback:function(a,e,t,i,D){a.getElementsByTagName("th")[0].innerHTML=`
            <div class="form-check">
               <input class="form-check-input datatable-group-checkable" type="checkbox" value="" id="groupCheckable" />
					<label class="form-check-label"></label>
            </div>`},createdRow:function(a,e,t){_dataTableSelectedValues.indexOf(e[_dataTableSelectColumn])>-1&&$(a).addClass("bg-light")},ajax:{url:`${_baseURL}/dt/configs/roles`,type:"GET",data:function(a){}},columns:[{data:"id",width:"30px",orderable:!1,searchable:!1,render:function(a,e,t,i){return`<div class="form-check">
                               <input class="form-check-input datatable-checkable" type="checkbox" value="${a}" ${_dataTableSelectedValues.indexOf(a)>-1?"checked":""} data-index="${i.row}" />
                                        <label class="form-check-label"></label>
                            </div>`}},{data:"name"},{data:"def_path"}]}).on("xhr.dt",function(a,e,t,i){setTimeout(()=>{_dataTable.columns.adjust()},300)}).on("draw.dt",function(a,e,t,i){b(_dataTable),l(!1,"#refresh")}),_(_dataTable,'input[type="search"]'),document.querySelector("#refresh").addEventListener("click",()=>c(!1))}function g(){_formValidation=$(document.querySelector("#formInput")).validate({rules:{name:{required:!0},def_path:{required:!0}},submitHandler:function(a,e){e.preventDefault(),$(a).valid()&&k()}})}function S(){$("#modalFormInput").on("hidden.bs.modal",u),h("#modalFormInput")}function x(){_permissions.edit&&document.querySelector("#edit").addEventListener("click",()=>{typeof _dataTable.row({selected:!0}).data()>"u"||y(_dataTable.row({selected:!0}).data().id.trim())}),_permissions.delete&&document.querySelector("#delete").addEventListener("click",w)}function v(){f("#name"),f("#def_path")}async function k(){l(!0,"#save"),s("#formInput"),o=`${_baseURL}/configs/roles`,_action==="edit"&&(o+=`/${_id}`);const a=_action==="create"?"POST":"PUT",e=await r(o,a,$("#formInput").serialize());if(![201,200].includes(e.status)){n.HtmlNotification(d(e.data),`${e.status} - ${e.statusText}`),m(e.data.errors),l(!1,"#save"),s("#formInput",!1);return}Toast.fire({icon:"success",title:e.statusText,text:e.data.message}),u(),c(!1),$("#modalFormInput").modal("hide"),l(!1,"#save"),s("#formInput",!1)}async function y(a=null){_id=a,s("#list_datatable");const e=await r(`${_baseURL}/configs/roles/${_id}`,"GET");if(![200].includes(e.status)){n.HtmlNotification(d(e.data),`${e.status} - ${e.statusText}`),s("#list_datatable",!1);return}u(),_action="edit";const t=e.data.data;$("#name").val(t.name),$("#def_path").val(t.def_path),$("#modalFormInput").modal("show"),s("#list_datatable",!1)}async function w(){if(_dataTableSelectedValues.length<=0){n.HtmlNotification("Select 1 atau more data.");return}if(!await n.Confirm(`Are you sure want to delete ${_dataTableSelectedValues.length} data?`).catch(t=>{t&&console.log(t)}))return;l(!0,"#delete"),s("#list_datatable"),_data2Send=new URLSearchParams({id:JSON.stringify(_dataTableSelectedValues)});const e=await r(`${_baseURL}/configs/roles`,"DELETE",_data2Send);if(![200].includes(e.status)){n.HtmlNotification(d(e.data),`${e.status} - ${e.statusText}`),m(e.data.errors),l(!1,"#delete"),s("#list_datatable",!1);return}Toast.fire({icon:"success",title:e.statusText,text:e.data.message}),p(),c(!1),l(!1,"#delete"),s("#list_datatable",!1)}function c(a=!0){l(!0,"#refresh"),_dataTableResetFilter=!1,_dataTable.ajax.reload(null,a)}function u(){_action="create",_data2Send=null,_formValidation.resetForm(),$("#formInput")[0].reset()}document.addEventListener("DOMContentLoaded",function(){T(),g(),S(),v(),x()});
